<script src="tinytest.js"></script>
<script>
    function toFixed(number, precision) {

        var power = Math.pow(10, precision);

        var finalNumStr;
        // 1. transfer number to string

        var numberStr = number + '';

        // if number contains decimal.
        if (numberStr.indexOf('.') !== -1) {
            // 2. move the dot from 1.165 => 116.5 

            var numberArr = numberStr.split('');

            // Need to add pre-process here for the array.
            // If total digits less than precision, need to add 0 at the end
            if (( /* total digits */ numberArr.length - numberArr.indexOf('.') - 1) < precision) {
                var preProcessArr = [];
                for (var i = 0; i <= (numberArr.indexOf('.') + precision); i++) {
                    if (numberArr[i]) {
                        preProcessArr.push(numberArr[i]);
                    } else {
                        preProcessArr.push('0');
                    }
                }
                numberArr = preProcessArr;
            }

            var numberArrNoDecimal = [];

            for (var i = 0; i < numberArr.length; i++) {

                if (numberArr[i] === '.') {

                    var decimalPosition = i;

                } else {

                    numberArrNoDecimal.push(numberArr[i]);
                }
            }

            if (decimalPosition) {

                var finalDecimalPosition = decimalPosition + precision;

            }

            var finalStrArr = [];

            if (finalDecimalPosition && finalDecimalPosition !== numberArrNoDecimal.length) {

                for (var j = 0; j <= numberArrNoDecimal.length; j++) {

                    if (j === finalDecimalPosition) {
                        finalStrArr.push('.');
                    }

                    if (numberArrNoDecimal[j]) {
                        finalStrArr.push(numberArrNoDecimal[j]);
                    }
                }
            }

            // '111.'
            if (finalDecimalPosition === numberArrNoDecimal.length) {
                finalStrArr = numberArrNoDecimal;
            }

            finalNumStr = finalStrArr.join('');
        } else {
            // number without decimal.
            var numberArr = numberStr.split('');

            var numberArrWithPrcision = [];

            for (i = 0; i < (numberArr.length + precision); i++) {
                if (numberArr[i]) {
                    numberArrWithPrcision.push(numberArr[i]);
                } else {
                    numberArrWithPrcision.push('0');
                }
            }

            finalNumStr = numberArrWithPrcision.join('');

        }

        // 3. transfer result string from step 2 to number. round the number using JS native function Math.round()
        // 4. Result from step 4 * precision

        return (Math.round(Number(finalNumStr)) / power).toFixed(precision);

    }


    tests({

        'Simple move : case 1 ': function() {

            eq('1.06', toFixed(1.056, 2));

        },


        'Simple move : case 2 ': function() {

            eq('1.05', toFixed(1.053, 2));

        },

        'Simple move : case 3 ': function() {

            eq('1.05', toFixed(1.050, 2));

        },


        'Decimal move to the last character : last digit is not 0': function() {

            eq('1.11', toFixed(1.11, 2));

        },

        'Decimal move to the last character : last digit is 0': function() {

            eq('1.10', toFixed(1.10, 2));

        },


        'Decimal overflow': function() {

            eq('1.10', toFixed(1.1, 2));

        },


        'No decimal': function() {

            eq(2.00, toFixed(2, 2));

        },


        'It should round 0.615 correctly to 0.62. Native toFixed does not correctly round this': function() {
            eq(toFixed(0.615, 2), '0.62');
        },
        'It should round 1.005 correctly to 1.01. Native toFixed does not correctly round this': function() {
            eq(toFixed(1.005, 2), '1.01');
        },
        'It should round 10.235 correctly to 10.24. Native toFixed does not correctly round this': function() {
            eq(toFixed(10.235, 2), '10.24');
        },
        'It should add 0 at end if necessary per the precision ': function() {
            eq(toFixed(100.5, 3), '100.500');
            eq(toFixed(1.01, 3), '1.010');
            eq(toFixed(100.5, 2), '100.50');
        },
        'It should round .62 to 0.620 when precision is 3': function() {
            eq(toFixed(.62, 3), '0.620');
        },
        // Tiffany's Test
        'It should pad 1.5 correctly to 1.5000': function() {
            eq(toFixed(1.5, 4), '1.5000');
        },
        // Kenney's Tests
        '"100" with 5 precision should return "100.00000"': function() {
            eq(toFixed(100, 5), '100.00000');
        },
        '".005" with 2 precision should return "0.01"': function() {
            eq(toFixed(.005, 2), '0.01');
        },
        '"1.005" with 2 precision return "1.01"': function() {
            eq(toFixed(1.005, 2), '1.01');
        },
        '"12314.12342145" with 7 precision return "12314.1234215"': function() {
            eq(toFixed(12314.12342145, 7), '12314.1234215');
        },
        'Precision greater than number of decimals': function() {
            eq(toFixed(12314.12342145, 10), '12314.1234214500');
        },
        // James's Tests
        'It should return 0.62': function() {
            eq(toFixed(.615, 2), '0.62');
        },
        'It should return 10.24': function() {
            eq(toFixed(10.235, 2), '10.24');
        },
        'It should return 1.01': function() {
            eq(toFixed(1.005, 2), '1.01');
        },
        'It should return 0.236': function() {
            eq(toFixed(.2356, 3), '0.236');
        },
        'It should return 10.7': function() {
            eq(toFixed(10.678, 1), '10.7');
        },
        'It should return 10': function() {
            eq(toFixed(10.235, 0), '10');
        },
        'It should return 11': function() {
            eq(toFixed(10.635, 0), '11');
        },
        'It should return 1.00201': function() {
            eq(toFixed(1.002005, 5), '1.00201');
        }

    });
</script>